import nmap
import os
import re
from shutil import copyfile
from action import Action

class NmapErpscanAction(Action):
    def __init__(self):
        super().__init__('sap_scan', ['full_scan_trigger'])
        self.nmap = nmap.PortScanner()

    def run(self, actions):

        path = self.getOutputPath()

        result = {}
        scanned = 0
        total = len(actions['_trigger']['params']['hosts'])


        for host in actions['_trigger']['params']['hosts']:

            ip = host['ip']
            self.reportProgress({'percentage': 100*scanned/total, 'description' : '{}/{} (scanning: {})'.format(str(scanned),str(total), ip)})
            print('Scanning host {}'.format(ip))

            ports = "35540,35541,35232,35233,35230,35231,32504,55618,51269,51268,51267,51266,51265,55619,51263,51262,51261,51260,55616,32232,32231,32230,55610,36709,36708,56121,56120,32011,32010,32017,32016,32015,51264,38503,38502,38501,38500,38507,38506,38505,38504,38509,38508,36840,36841,58219,58218,38640,38641,58210,58213,58215,58214,58217,58216,30411,30410,30415,30417,30416,33506,33507,33504,33505,33502,33503,33500,33501,33508,33509,44427,44426,44425,44424,44423,44422,44421,44420,44429,44428,31232,31233,31230,31231,8019,8018,8017,8016,8015,8014,8013,8012,8011,8010,50419,50418,50413,35930,35933,35932,50417,50416,50415,50414,65080,65081,65082,65083,65084,65085,65086,65087,65088,65089,55621,55620,4730,52810,52813,52815,52814,52817,52816,52819,52818,31908,31909,31904,31905,31906,31907,31900,31901,31902,31903,32225,32229,56820,56821,4620,43680,51106,51107,51104,51105,51102,51103,51100,51101,51108,51109,52103,52102,52101,52100,52107,52106,52105,52104,52108,36309,36308,36303,36302,36301,36300,36307,36306,36305,36304,42480,7210,54419,54418,54417,54416,54415,54414,54413,54410,59621,59620,40880,53508,53504,53505,53506,53507,53500,53501,53502,53503,37304,37305,37306,37307,37300,37301,37302,37303,37308,37309,30629,30625,54905,40080,41680,33933,33240,1546,1547,47680,1545,1542,1543,1540,1541,1548,1549,34301,34300,34303,34302,30330,30331,30332,30333,34309,34308,55102,55103,55100,55101,55106,55107,55104,55105,55108,35215,35216,35217,35210,35211,35803,35802,39016,39017,39015,39010,56108,56107,56106,56105,56104,56103,56102,56101,56100,55818,55819,51821,51820,55816,55817,55810,55813,55201,55200,55203,57418,57419,32606,57410,57416,57417,57414,32607,55207,55206,3689,3688,3683,3682,3681,3680,3687,3686,3685,3684,53315,36825,36829,38625,38629,30433,30432,30431,30430,33529,33525,59010,59013,59014,59015,59016,59017,59018,59019,31210,31211,31215,31740,31217,8035,8034,8037,8036,8031,8030,8033,8032,8039,8038,34532,34533,34530,34531,35917,35916,35915,35911,35910,65068,65069,65066,65067,65064,65065,65062,65063,65060,65061,4290,4740,57904,55317,55316,55315,55314,55313,55310,55319,55318,57905,4600,51128,51129,51124,51125,51126,51127,51120,51121,51122,8139,6187,6186,6185,6184,6183,6182,6181,6180,6189,6188,39809,39808,39805,39804,39807,39806,39801,39800,39803,39802,10514,50800,50801,50802,50803,35610,35615,35616,35341,30600,30601,30602,30603,30604,30605,30606,30607,30608,30609,34325,31009,31008,31005,31004,31007,31006,31001,31000,31003,31002,3955,3954,37310,55120,55121,8192,8193,8190,8191,8196,8197,8194,8195,8198,8199,59208,51425,51424,39030,39031,39032,39033,51807,51806,51805,51804,51803,51802,51801,51800,51353,32729,51808,51423,42780,51422,4680,54320,43780,38815,38817,38816,38811,38810,38541,38540,36808,36809,36800,36801,36802,36803,36804,36805,36806,36807,54208,33729,54206,54207,54204,54205,54202,54203,54200,54201,38608,38609,38600,38601,38602,38603,38604,38605,38606,38607,36110,36111,36116,36117,36115,33540,33541,39632,39633,57920,57921,4976,37641,37640,8053,8052,8051,8050,8057,8056,8055,8054,8059,8058,50321,50320,58521,58520,31940,31941,35641,35640,65044,65045,65046,65047,65040,65041,65042,65043,51326,32917,51324,32915,65048,65049,51320,51321,56318,56319,56316,56317,56314,56315,56313,56310,51148,51149,51142,51143,51140,51141,51146,51147,51144,51145,36341,36340,38411,4888,4889,58806,4880,4881,4882,4883,4884,4885,4886,4887,58808,39829,39825,54521,6115,33400,6112,6113,37340,37341,37432,37433,37430,37431,38701,38700,52510,54013,38709,54010,54017,54016,54015,54014,54019,54018,56010,1588,1589,48480,38015,1583,38017,1581,1586,1587,1584,1585,31029,31531,31530,31533,31532,31025,35931,50410,59221,59220,3917,3916,3915,3914,3913,3912,3911,3910,3919,3918,34705,34704,34707,34706,34701,34700,34703,34702,34709,34708,56410,56413,56415,56414,56417,56416,56419,56418,32703,32702,32701,32700,32707,32706,55500,55501,32709,32708,55508,36716,36241,46080,3649,3648,3647,3646,3645,3644,3643,3642,3641,3640,51383,58019,58018,58017,58016,58015,58014,58013,58010,38833,38832,38831,38830,4410,58908,58901,58900,58903,58902,58905,58904,58907,58906,45280,36130,36131,36132,36133,55515,44481,44480,44483,44482,44485,44484,44487,44486,44489,44488,57906,57907,57900,57901,57902,57903,33704,33705,33706,33707,54220,54221,33702,33703,33708,33709,39531,39530,39533,39532,59502,59503,59500,59501,59506,59507,59504,59505,31702,31703,31700,31701,31706,31707,31704,31705,31708,31709,51556,8079,30032,30031,30030,8071,8070,8073,8072,8075,8074,8077,8076,50308,50303,50302,50301,50300,50307,50306,50305,50304,1447,1446,1445,1444,1443,1442,1441,1440,1449,1448,4580,38225,38229,4720,35629,35625,4780,51304,51305,51306,51307,51300,51301,51302,51303,51308,51309,65022,65023,65020,65021,65026,65027,65024,65025,65028,65029,56620,56621,51160,51161,51162,51163,51164,51165,51166,51167,51168,51169,39008,52301,52300,52303,52302,52305,52304,52307,52306,52308,39841,39840,31625,32008,32009,53218,53219,53214,53215,53216,53217,53210,53213,37415,37416,37417,37410,37411,32007,54916,54917,54914,37040,54913,54910,33911,33910,33915,33917,33916,38033,38032,38031,38030,51555,51554,51557,1304,1305,1306,1307,1300,1301,1302,1303,51551,1308,1309,51550,51553,51552,56016,30932,30933,30930,30931,31041,31040,50820,50821,35016,35017,31511,31510,3939,3938,3935,3934,3937,3936,3931,3930,3933,3932,34725,34729,35810,35811,55520,55521,4040,3665,3664,3667,3666,3661,3660,3663,3662,3669,3668,56616,57218,57219,57210,56615,57213,57214,57215,57216,57217,4430,36732,36733,53915,36731,53913,53910,53919,53918,48380,49380,3971,36016,58921,58920,3973,59520,59521,30231,30230,30233,30232,3385,39517,3382,39515,3972,39511,39510,31729,3380,3381,31725,37609,37608,37601,37600,37603,37602,37605,37604,37607,37606,34008,34009,34002,34003,34000,34001,34006,34007,34004,34005,3974,1469,1468,3977,1465,1464,1467,1466,1461,1460,1463,1462,3976,4230,38208,38209,38204,38205,38206,38207,38200,38201,38202,38203,35607,35606,35605,35604,35603,35602,35601,35600,35609,35608,51491,51362,51363,51360,51361,51366,51367,51364,51365,51368,51369,65008,65009,65000,65001,65002,65003,65004,65005,65006,65007,36707,51188,51189,51186,51187,51184,51185,51182,51183,51180,51181,46380,56600,56601,56602,56603,56604,56605,56606,56607,56608,52321,52320,57008,57005,57004,57007,57006,57001,57000,57003,57002,56521,38633,56520,38440,38441,4590,4848,4849,4844,4845,4846,4847,4840,4841,4842,4843,58608,58606,58607,58604,58605,58602,58603,58600,58601,54721,54720,33931,33930,34929,34925,36541,1322,1323,1320,1321,1326,1327,1324,1325,1328,1329,30910,30911,8138,30915,30916,30917,8134,8135,8136,8137,8130,8131,8132,8133,50808,35030,35031,35032,35033,50804,50805,50806,50807,51348,3959,3958,3953,3952,3951,3950,3957,3956,55720,55721,34741,34740,33408,51436,50118,50119,51437,50113,50110,50116,50117,50114,50115,51435,51432,51433,51430,51431,4060,3603,3602,3601,3600,3607,3606,3605,3604,3609,3608,32741,32740,56015,56014,56017,52513,52514,52515,56013,52517,52518,52519,56019,56018,4450,36710,36711,36715,36240,36717,59720,59721,54918,54919,33740,33741,37041,54915,33032,33033,33030,33031,30211,30210,30217,30216,30215,37625,37629,58816,58413,3387,3384,58410,58417,3383,58415,58414,58419,58418,3388,3389,1409,1408,34240,34241,1403,1402,1401,1400,1407,1406,1405,1404,4210,1544,34025,34029,31306,31307,31304,31305,31302,31303,31300,31301,31308,31309,1494,51349,51438,51439,51340,51341,51342,51343,51344,51345,51346,51347,34305,1495,34304,34307,34306,39131,39130,39133,39132,55607,6109,6108,6107,6106,6105,6104,6103,6102,6101,6100,57021,57020,55601,33140,55600,54821,42280,34525,4868,4869,4862,4863,4860,4861,4866,4867,4864,4865,58620,58621,52705,52704,52707,52706,52701,52700,52703,52702,52708,36509,36508,36505,36504,36507,36506,36501,36500,36503,36502,54703,54702,54701,54700,54707,54706,54705,54704,37906,37907,37904,37905,37902,37903,37900,37901,41480,34909,34908,34903,34902,34901,34900,34907,34906,34905,34904,37241,37716,47880,40280,1348,1349,1340,1341,1342,1343,1344,1345,1346,1347,8118,8119,30541,8112,8113,8110,30540,8116,8117,8114,8115,39308,39309,39306,39307,39304,39305,39302,39303,39300,39301,51595,55320,55321,51597,47080,4000,55704,55705,55706,32502,55700,55701,32507,55703,32509,3978,55708,51089,51088,3629,3628,3621,3620,3623,3622,3625,3624,3627,3626,35416,35417,35415,35410,35411,57702,57703,57700,57701,57706,57707,57704,57705,57708,51495,4470,51497,51490,59708,58815,59700,59701,59702,59703,59704,59705,59706,59707,53621,53620,33015,33016,33017,33010,33011,51492,37029,44315,44314,44317,44316,44311,44310,44313,44312,44319,44318,1421,1420,1423,1422,1425,1424,1427,1426,1429,1428,3366,3367,3360,3361,3362,3363,34225,34229,4270,38240,38241,31329,35311,35310,35315,35317,35316,51414,51415,51416,51417,51410,51411,51412,51413,51418,51419,39011,39111,39110,39117,39116,39115,55919,55918,6127,6126,6121,6120,6123,6122,32332,32333,32330,32331,55915,55914,55917,55916,34440,55814,55815,4800,4801,4802,38409,4804,4805,4806,4807,38402,38403,38400,38401,38406,38407,38404,38405,57517,53013,57515,57514,57513,53017,53014,53015,53018,53019,57519,57518,52721,52720,54921,54920,36529,36031,36030,36033,36032,36525,33209,33208,35029,33201,33200,33203,33202,33205,33204,33207,33206,37908,37909,30206,54708,54610,35825,59119,59118,59115,59114,59117,59116,59110,59113,37925,51011,37929,8170,8171,8172,8173,8174,8175,8176,8177,8178,8179,51543,39325,35829,51541,39329,57413,57415,4398,4399,4390,4391,4392,4393,4394,4395,4396,4397,1366,1367,1364,1365,1362,1363,1360,1361,1368,1369,4020,51069,51068,3999,3998,3997,3996,3995,3994,3993,3992,3991,3990,43180,35430,35431,35432,35433,57720,57721,51608,51601,51600,51603,51602,51605,51604,51607,51606,52008,52002,52003,52000,52001,52006,52007,52004,52005,36202,36203,36200,36201,36206,36207,36204,36205,43980,36208,36209,42580,39929,39925,53607,53606,53605,53604,53603,53602,53601,53600,53608,40980,37009,37008,37007,37006,37005,37004,37003,37002,37001,37000,40180,1436,1437,1434,1435,58408,1433,3207,3206,3205,3204,3203,3202,3201,3200,1431,3209,3208,3399,3398,41580,44333,44332,44331,44330,44337,44336,44335,44334,44339,44338,58321,58320,1439,34231,3348,3349,30205,3342,3343,3340,3341,3346,3347,3344,3345,34208,34209,30207,30529,34200,34201,34202,34203,34204,34205,34206,34207,31129,4250,31125,31340,31341,51472,51473,51470,51471,51476,51477,51474,31106,51478,51479,59320,59321,35333,35840,35331,35330,32310,51297,51294,51295,51292,32315,32640,32317,51298,51299,6143,6142,6141,6140,6147,6146,6145,6144,6149,6148,8111,52921,52920,56910,56913,56914,56915,56916,56917,56918,38429,4828,4829,4826,4827,4824,4825,4822,4823,4820,4821,33441,33440,36017,36540,36015,36011,36010,34941,34940,33225,37941,33229,8158,8159,8156,8157,8154,8155,8152,8153,8150,8151,39340,39341,50718,50719,50710,50713,50714,50715,50716,50717,1388,1389,1384,1385,1386,1387,1380,1381,1382,1383,51599,51598,51049,51048,51043,51042,51041,32810,32817,51046,32815,51044,56219,56218,56213,56210,56217,56216,56215,56214,51621,51620,36229,36225,39904,39905,39906,39907,39900,39901,39902,39903,39908,39909,32105,32104,32107,32106,32101,32100,32103,32102,32109,32108,52020,52021,57306,57307,57304,57305,57302,57303,57300,57301,57308,46680,44680,3229,3228,3225,3224,3227,3226,3221,3220,3223,3222,45080,44359,44358,44351,44350,44353,44352,44355,44354,44357,44356,3320,3321,58301,58300,3324,3325,3326,3327,3328,3329,58308,32501,45880,3970,32503,30509,55707,30503,30502,30501,30500,30507,30506,30505,30504,55702,32506,3979,32508,51458,51459,51450,51451,51452,51453,51454,51455,51456,51457,30341,59308,30616,59304,59305,59306,59307,59300,59301,59302,59303,31104,35130,35133,31107,31100,31101,31102,31103,31108,31109,30610,34625,34629,50508,50505,50504,50507,50506,50501,50500,50503,50502,51908,51906,51907,51904,51905,51902,51903,51900,51901,6169,6168,51040,6161,6160,6163,6162,6165,6164,6167,6166,52908,52903,52902,52901,52900,52907,52906,52905,52904,51047,31816,31817,31815,31810,31811,51045,6133,6137,6135,4510,58820,58821,39711,39710,39715,39717,39716,54501,54500,54503,54502,54505,54504,54507,54506,33429,54508,51325,53416,53417,53414,53415,53413,53410,53418,53419,51322,37216,37217,37215,37740,37741,37210,37211,34433,34432,34431,34430,4358,4359,4354,4355,4356,4357,4350,4351,4352,4353,38141,38140,51389,51021,51020,51023,55017,55010,51024,51027,55013,51029,51028,55018,55019,51384,51385,1432,51386,52220,52221,51387,51080,1430,32125,32129,51380,51381,53319,53318,53310,53313,57320,57321,53317,53316,37511,37510,49180,37515,37517,37516,51382,4981,4980,4983,4982,4985,4984,4987,4986,4989,4988,49980,3249,3248,3243,3242,3241,3240,3247,3246,3245,3244,59818,59819,38410,59810,59813,59814,59815,59816,59817,4879,1483,1482,1481,1480,1487,1486,3308,3309,3306,3307,3304,3305,3302,3303,3300,3301,48580,36606,36607,36604,36605,36602,36603,36600,36601,36608,36609,1438,54105,44377,44376,44375,44374,44373,44372,44371,44370,515,44379,44378,1227,1226,1225,1224,1223,1222,1221,1220,59404,1229,1228,34040,59408,32240,34041,32241,35117,35116,35115,35111,35110,34608,34609,34604,34605,34606,34607,34600,34601,34602,34603,35809,35808,35801,35800,50521,50520,35805,35804,35807,35806,55208,32608,32609,32602,32603,32600,32601,55205,55204,32604,32605,4160,31608,51064,46180,51067,37025,31830,31831,31832,31833,51920,51921,51061,4570,51060,45180,51063,51062,46980,45980,39733,39732,39731,39730,44580,58800,58801,58802,58803,58804,58805,33409,58807,33407,33406,33405,33404,33403,33402,33401,54520,50000,54717,50001,50002,35833,37230,37231,37232,37233,37729,51123,37725,30710,30711,30716,30717,30715,50202,50203,50200,50201,50206,50207,50204,50205,50208,4378,4379,4372,4373,4370,4371,4376,4377,4374,4375,38129,38125,4080,31441,31440,51559,51558,51009,51008,51007,51006,51005,51004,51003,51002,51001,51000,8084,8085,8086,8087,8080,8081,8082,8083,8088,8089,32908,52208,52200,52201,52202,52203,52204,52205,52206,52207,39940,39941,57120,57121,32141,32140,37933,37932,37533,37532,37531,37530,4969,4968,4967,4966,4965,4964,4963,4962,4961,4960,51287,3261,3260,3263,3262,3265,3264,3267,3266,3269,3268,3369,3364,36910,36911,36916,36917,36915,54310,54313,54314,54315,54316,54317,54318,54319,38710,38711,38716,38717,38715,34840,34841,36629,36625,44399,44398,44395,44394,44397,44396,44391,44390,44393,44392,51087,1209,1208,1205,1204,1207,1206,1201,1200,1203,1202,8106,30815,30817,30816,30811,30810,51086,39441,39440,31140,31141,31632,31633,31630,31631,1357,1356,51084,50017,50016,50015,50014,50013,50010,50019,50018,51083,51082,4140,32440,32441,51081,33730,35531,35530,35533,35532,32625,55221,55220,32629,52419,52418,52415,52414,52417,52416,52410,52413,4550,39603,49280,30425,54819,54818,31325,54813,54810,54817,54816,54815,54814,37700,37701,37702,37703,37704,37705,37706,37707,37708,37709,36106,50220,50221,4310,4311,4312,4313,4314,4315,4316,4317,4318,4319,40480,33825,54104,54107,54106,54101,54100,54103,54102,33829,54108,38107,38106,38105,38104,38103,38102,38101,38100,38109,38108,30730,30731,30732,30733,35708,35709,35706,35707,35704,35705,35702,35703,35700,35701,47280,51579,51578,51573,51572,51571,51570,51577,51576,51575,51574,3975,56508,56503,56502,56501,56500,56507,56506,56505,56504,4945,4944,4947,4946,4941,4940,4943,4942,4949,4948,57104,57105,57106,57107,57100,57101,57102,57103,57108,58101,58100,58103,58102,58105,58104,58107,58106,58108,3289,52621,3287,3286,3285,3284,3283,3282,3281,3280,36429,36930,36931,36932,36425,33616,33617,33615,33340,33341,33610,33611,38730,38731,38732,38733,51092,32511,51094,36640,36641,3989,51097,51098,51099,57816,57817,57814,57815,57813,57810,57818,57819,1269,1268,52620,1263,1262,1261,3288,1267,1266,1265,1264,59418,59419,30833,59415,30831,30830,59410,59413,31615,31616,31617,31610,31611,37115,37117,37116,37111,37110,34640,34641,34132,34329,34130,34131,6125,6124,34507,34506,34505,34504,55910,34503,55913,34502,6152,34501,6129,34500,6128,55421,55420,32425,32429,38932,38933,38930,38931,35511,35510,35517,35516,35515,50816,36933,51218,51219,51216,51217,51214,51215,51212,51213,51210,51211,50910,10000,33111,33110,33115,33117,33116,56020,56021,44456,44457,44454,44455,44452,44453,44450,44451,44458,44459,50918,30132,30133,30130,30131,4338,4339,4336,4337,4334,4335,4332,4333,4330,4331,33803,33802,33801,33800,33807,33806,33805,33804,33809,33808,34510,20201,31409,31408,31401,31400,31403,31402,31405,31404,31407,31406,51511,51510,51513,51512,51515,51514,51517,51516,51519,51518,59205,59204,59207,59206,59201,59200,59203,59202,35725,34515,35729,34516,50606,50607,50604,50605,50602,50603,50600,50601,50608,43380,42380,34310,51816,4923,4922,4921,4920,4927,4926,4925,4924,4929,4928,1538,53119,53118,53117,53116,53115,53114,53113,53110,38408,58121,58120,4803,52608,52604,52605,52606,52607,52600,52601,52602,52603,36404,36405,36406,36407,36400,36401,36402,36403,36408,36409,53808,4809,53801,53800,53803,53802,53805,53804,53807,53806,54608,33329,54602,54603,54600,54601,54606,54607,54604,33325,34802,34803,34800,34801,34806,34807,34804,34805,41380,34808,34809,57516,53010,53016,1260,57510,40380,37841,37840,33630,33631,33632,33633,54113,33830,39401,59414,39403,39402,39405,39404,39407,30832,39409,39408,59416,51483,59417,51482,51481,37133,37132,37131,37130,32909,51338,51485,34115,34116,34117,34110,34111,32905,51334,51337,62026,51336,51331,51330,1241,1536,1535,1534,1533,1532,1531,1530,1249,1248,51332,1539,47380,32725,4100,32408,32409,38315,38310,55408,32400,32401,32402,32403,32404,32405,32406,32407,38910,38911,38915,38916,38917,51234,51235,51236,51237,51230,51231,51232,51233,51238,51239,51720,51721,56718,56719,56713,56710,56716,56717,56714,56715,34133,33133,33132,33131,33130,35010,4480,52516,44478,44479,44474,44475,44476,44477,44470,44471,44472,44473,58710,35011,58713,58714,58715,58716,58717,58718,58719,30110,30111,30115,30440,30441,31241,31240,37832,37833,37830,37831,35015,51539,51538,51537,51536,51535,51534,51533,51532,51531,51530,52316,50913,35740,35741,50916,50917,50914,50915,39232,39233,39230,50919,31429,51393,51392,51391,51390,51397,51396,51395,51394,32215,32217,51398,32211,32210,52315,50620,50621,31931,31930,31933,31932,4120,56819,56818,56815,56814,56817,56816,56810,56813,4909,4908,4901,4900,4903,4902,4905,4904,4907,4906,53821,53820,34829,34825,32316,33300,33301,33302,33303,33304,33305,33306,33307,33308,33309,37331,37330,37333,37332,59906,59907,59904,59905,59902,59903,59900,59901,30305,30304,30307,30306,30301,30300,30303,30302,44080,39429,39425,4240,44880,58505,58504,58507,58506,58501,58500,58503,58502,58508,1519,1518,1515,1514,1517,1516,1511,1510,1513,1512,32516,38330,38331,38332,38333,35225,33725,35229,43080,51700,51701,51702,51703,51704,51705,51706,51707,51708,51258,51259,48880,43880,32025,55821,55820,32029,53708,53706,53707,53704,53705,53702,53703,53700,53701,37816,38532,38533,38530,38531,44418,44419,44412,44413,44410,44411,44416,44417,44414,44415,36141,36140,37810,37811,33517,33516,33511,33510,33841,37817,59021,59020,31225,31229,34541,34540,8008,8009,8004,8005,8006,8007,8000,8001,8002,8003,39210,39211,39215,39216,39217,39631,35940,35941,50420,50421,65097,65096,65095,65094,65093,65092,65091,65090,32233,55617,55614,55615,55613,65099,65098,31911,31910,31917,31916,31915,4650,57614,57615,57616,57617,57610,57613,57618,57619,51115,51114,51117,51116,51111,51110,51113,51112,51119,51118,36440,36441,36332,36333,36330,36331,33940,54021,7269,54420,54421,59613,59610,59616,59617,59614,59615,59618,59619,48780,53513,51065,53510,53517,53516,53515,53514,53519,53518,32525,51066,49780,32831,32830,32833,37311,32832,37317,37316,37315,51285,30329,51284,30631,30630,30633,30632,59920,59921,30325,51286,51281,51280,51283,51282,1285,1284,1287,1286,1281,1280,1283,1282,1289,1288,1579,1578,1573,1572,1571,1570,1577,1576,1575,1574,30015,34511,30017,6158,30016,6159,30011,30010,55110,55113,55115,55114,55117,55116,55119,55118,34517,4180,35203,35202,35201,35200,35207,35206,35205,35204,35209,35208,51278,51279,51270,51271,51272,51273,51274,51275,51276,51277,1244,39005,39004,39007,39006,39001,39000,39003,39002,39009,54613,55803,55802,55801,55800,55807,55806,55805,55804,32004,32005,32006,55808,32000,32001,32002,32003,57408,57401,57400,57403,57402,57405,57404,57407,57406,46780,3698,3699,3690,3691,3692,3693,3694,3695,3696,3697,44780,45780,38515,38516,38517,38510,38511,36831,36830,36833,36832,53720,53721,38631,38630,58208,38632,58202,58203,58200,58201,58206,58207,58204,58205,30402,30403,30400,30401,30406,30407,30404,30405,30408,30409,33533,33532,33531,33530,44430,44431,44432,44433,44434,44435,44436,44437,44438,44439,59007,59006,59005,59004,59003,59002,59001,59000,59008,31209,31208,31207,31206,31205,31204,31203,31202,31201,31200,59214,34529,8028,8029,8022,8023,8020,8021,8026,8027,8024,8025,50404,50405,50406,50407,50400,50401,50402,50403,50408,35929,35925,65079,65078,65075,65074,65077,65076,65071,65070,65073,65072,52802,52803,52800,52801,52806,52807,52804,52805,52808,8182,4280,4750,38433,38432,38431,38430,4630,51133,51132,51131,51130,51137,51136,51135,51134,51139,51138,52118,52119,52114,52115,52116,52117,52110,52113,36315,36316,36317,36310,36311,4760,6194,6195,6196,6197,6190,6191,6192,6193,6198,6199,7200,54408,54400,54401,54402,54403,54404,54405,54406,54407,51592,54121,54120,51498,51499,51328,51329,51494,51327,51496,1551,1550,1553,1552,1555,1554,1557,1556,1559,1558,51323,30617,30340,30615,34311,34316,34317,30611,34315,51493,51810,32041,35041,35040,55516,51814,55510,32730,51817,33416,56118,56119,39025,56110,39029,56113,56114,56115,56116,56117,49080,55202,49880,57421,57420,36817,36816,36815,36811,36810,58220,58221,54219,54218,54215,54214,54217,54216,33731,54210,54213,33732,48680,38617,38616,38615,38611,38610,30429,1525,1526,36109,36108,1527,36101,36100,36103,36102,36105,36104,36107,1521,1522,1523,39625,39629,1128,1129,8040,8041,8042,8043,8044,8045,8046,8047,8048,8049,34509,34508,35900,35901,35902,35903,35904,35905,35906,35907,35908,35909,65059,65058,65053,65052,65051,65050,65057,65056,65055,65054,52820,52821,4770,55300,55301,55302,55303,55304,55305,55306,55307,55308,32904,32907,32906,32901,32900,32903,32902,56308,56305,56304,56307,56306,56301,56300,56303,56302,4610,31216,51159,51158,51151,51150,51153,51152,51155,51154,51157,51156,39816,39817,39815,39810,39811,53221,53220,30525,37429,37425,30741,30740,54020,33941,34330,34331,34332,34333,31016,31017,31015,31540,31541,31010,31011,59216,59217,30941,30940,8189,8188,59210,8185,8184,8187,8186,8181,8180,8183,59219,3904,3905,3906,3907,3900,3901,3902,3903,3908,3909,50003,35241,35240,39041,39040,32040,55514,55517,51813,32732,51815,55513,32731,51818,51819,55519,55518,3658,3659,3654,3655,3656,3657,3650,3651,3652,3653,58416,57221,57220,58020,58021,38806,38807,38804,38805,38802,38803,38800,38801,38808,38809,4404,4405,4400,4190,36741,36740,33711,33710,33717,33716,33715,36125,36129,51546,51547,57913,39602,39601,57910,57917,39606,57915,57914,39609,57918,51544,51545,59519,59518,39540,39541,59510,59513,59515,59514,59517,59516,31711,31710,31715,31717,31716,51542,33241,30006,30007,30004,30005,30002,30003,30000,8069,8066,8067,8064,8065,8062,8063,8060,8061,39600,39607,57916,39605,51540,39604,1454,1455,1456,1457,1450,1451,1452,1453,1458,57919,39608,38231,38230,38233,38232,4690,4790,65031,65030,32929,65032,65035,65034,65037,65036,65039,65038,51311,51310,51317,51316,51315,51314,56321,56320,51177,51176,51175,51174,51173,51172,51171,51170,51427,51179,51178,43580,51426,4899,4898,39830,39831,39832,39833,4893,4892,4891,4890,4897,4896,4895,4894,42180,35841,35332,53203,53202,53201,53200,53207,53206,53205,53204,53208,51076,42980,51077,51074,37409,32533,37403,37402,37401,37400,37407,37406,37405,37404,1582,41980,1580,51296,38016,32311,38011,38010,31741,51293,51290,32641,41180,1595,1594,1597,1596,1591,1590,1593,1592,54004,54005,54006,54007,54000,1598,54002,54003,38008,38009,38006,38007,38004,38005,38002,38003,38000,38001,31529,31525,47580,8068,30001,40580,30008,30009,30929,30925,35001,35000,35003,35002,31030,31031,31032,35006,35009,35008,59215,3922,3923,3920,3921,3926,3927,3924,3925,3928,3929,34716,34717,34715,34710,34711,56402,56403,56400,56401,56406,56407,56404,56405,56408,59213,32715,32716,32717,32710,32711,54605,3678,3679,3672,3673,3670,3671,3676,3677,3674,3675,57208,57207,57206,57205,57204,57203,57202,57201,57200,58008,58000,58001,58002,58003,58004,58005,58006,58007,38829,52521,38825,36725,36729,4420,1459,53920,53921,58918,58919,58913,58910,58916,58917,58914,58915,59218,44492,44493,44490,44491,44496,44497,44494,44495,44498,44499,39525,39529,31733,31732,31731,31730,30029,34011,30025,34015,34017,34016,50314,50315,50316,50317,50310,50313,50318,50319,1472,1473,1470,1471,1476,1477,1474,1475,1478,1479,4220,25,38211,38210,38217,38216,38215,35632,35633,35630,35631,32941,32940,51373,51372,51375,51374,51377,51376,51379,51378,65019,65018,65017,65016,65015,65014,65013,65012,65011,38425,56919,51199,51198,51195,51194,51197,51196,51191,51190,51193,51192,56617,52313,52310,56614,56613,52317,52314,56610,52318,52319,56619,56618,4530,39400,57315,39406,57316,58619,58618,58615,58614,58617,58616,58610,58613,53615,53616,37825,65033,51318,36941,57318,51313,33908,33909,51312,33902,33903,33900,33901,33906,38029,33904,33905,32925,55506,55507,55504,55505,55502,55503,32705,32704,1317,1316,1315,1314,1313,1312,1311,1310,1319,1318,30907,30906,30905,30904,30903,30902,30901,30900,30909,30908,31500,31501,31502,31503,31504,31505,31506,31507,50817,31509,50815,50814,50813,50810,3948,3949,3940,3941,3942,3943,3944,3945,3946,3947,33041,37541,34730,34731,34732,34733,56420,56421,4808,50108,50101,50100,50103,50102,50105,50104,50107,50106,4050,51501,43280,3610,3611,3612,3613,3614,3615,3616,3617,3618,3619,52507,52506,52505,52504,52503,52502,52501,52500,52508,4440,38840,38841,33417,53900,53901,53902,53903,53904,53905,53906,53907,53908,36706,36705,36704,36703,36702,36701,36700,42080,41280,1537,1240,1243,1242,1245,42880,1247,1246,39641,39640,33029,54908,33025,54904,54907,54906,54901,54900,54903,54902,37016,30229,30225,39508,39509,39500,39501,39502,39503,39504,39505,39506,39507,37017,37610,37611,37616,37617,37615,30040,30041,58420,58421,1418,1419,1410,1411,1412,1413,1414,1415,1416,1417,4200,36730,34033,34032,34031,34030,31315,35611,31317,31316,31311,31310,35340,35617,51429,51428,51359,51358,51357,51356,51355,51354,51421,51420,51351,51350,1484,50901,38317,46880,38311,55407,32341,32340,55406,55405,55404,6118,6119,6114,55403,6116,6117,6110,6111,51434,55402,55401,55400,1488,57018,57019,57016,57017,57014,57015,57013,57010,37940,37441,37440,33733,4859,4858,4857,4856,4855,4854,4853,4852,4851,4850,34415,34417,34416,33925,37915,33929,37917,37916,37911,37910,34410,38040,38041,34932,34933,34930,34931,51010,1339,1338,443,1334,1337,1336,1331,1330,1333,1332,8129,8128,8127,8126,8125,8124,8123,8122,8121,8120,39315,39317,39316,39311,39310,55719,55718,55713,55710,55717,55716,55715,55714,50121,50120,33932,37408,4070,3966,3967,3964,3965,3962,3963,3960,3961,3968,3969,3638,3639,3636,3637,3634,3635,3632,3633,3630,3631,35405,35404,35407,35406,35401,35400,35403,35402,35409,35408,57710,57713,57715,57714,57717,57716,57719,57718,56006,56007,56004,56005,56002,56003,56000,56001,56008,4460,45580,46580,59719,59718,59717,59716,59715,59714,59713,59710,10443,59314,33009,33008,33003,33002,33001,33000,33007,33006,33005,33004,51352,44180,37630,37631,37632,37633,44980,57908,3391,3390,3393,3392,3395,3394,3397,3396,58404,58405,58406,58407,58400,58401,58402,58403,30204,34230,34233,34232,30200,30201,30202,30203,30208,30209,4260,39617,39610,39611,51489,58517,33700,33701,31333,31332,31331,31330,48980,51409,51408,51403,51402,51401,51400,51407,51406,51405,51404,4660,39125,39129,32329,32325,6138,6139,6132,57621,6130,6131,6136,59508,6134,57620,54008,57520,57521,1599,54001,51591,51590,51593,4875,4874,4877,4876,4871,4870,4873,4872,56921,56920,38415,4878,38417,51594,53001,53000,53003,53002,53005,53004,53007,53006,53008,51596,52716,52717,52714,52715,52713,52710,52718,52719,9786,36516,36517,36515,36040,36041,36510,36511,54718,54719,54714,54715,37931,37930,54710,54713,34915,34916,34917,34910,34911,30033,8078,6173,8105,8104,8107,1358,8101,8100,8103,8102,1353,1352,1351,1350,8109,8108,1355,1354,50721,50720,39333,39332,39331,39330,51480,51487,4010,51090,51091,32510,51093,3988,32517,51096,32515,3984,3985,3986,3987,3980,3981,3982,3983,51486,35425,35429,52019,52018,51484,52010,52013,52015,52014,52017,52016,36211,36210,36215,36217,36216,39931,39930,39933,39932,51488,2200,2202,37032,37033,37030,37031,49680,3214,3215,3216,3217,3210,3211,3212,3213,3218,3219,48080,44306,44307,44304,44305,44302,44303,44300,44301,44308,44309,3379,3378,3377,3376,3375,3374,3373,3372,3371,3370,34217,34216,34215,34211,34210,31131,31130,31133,31132,35005,35004,35308,35309,35007,35302,35303,35300,35301,35306,35307,35304,35305,51461,51460,51463,51462,51465,51464,51467,51466,51469,51468,33317,33316,39108,39109,39104,39105,39106,39107,39100,39101,39102,39103,32307,32306,32305,32304,32303,32302,32301,32300,51289,51288,32309,32308,6150,6151,55908,6153,6154,6155,6156,6157,55902,55903,55900,55901,55906,55907,55904,55905,30116,30117,46480,8300,30840,59916,4520,59910,59919,59918,56907,56906,56905,56904,56903,56902,56901,56900,32930,56908,4813,4812,4811,4810,4817,4816,4815,4814,45680,4819,4818,57500,57501,57502,57503,57504,57505,57506,57507,57508,53021,53020,36530,36531,36532,36533,36029,36025,33210,33211,33216,33217,33215,39740,39741,31033,59108,59106,59107,59104,59105,59102,59103,59100,59101,8163,8162,8161,8160,8167,8166,8165,8164,8169,8168,51057,50708,50707,50706,50705,50704,50703,50702,50701,50700,4389,4388,4383,4382,4381,4380,4387,4386,4385,4384,1371,1370,1373,1372,1375,1374,1377,1376,1379,1378,4030,54321,51078,32829,32530,32531,32532,32825,55021,55020,51070,51071,56220,56221,35441,35440,51618,51619,51613,51610,51616,51617,51614,51615,36233,36232,36231,36230,39911,39910,39917,39916,39915,53610,57314,57317,53613,53614,57310,57313,53617,53618,53619,57319,36940,37010,37011,37015,37540,33040,3232,3233,3230,3231,3236,3237,3234,3235,3238,3239,59821,59820,44328,44329,44324,44325,44326,44327,44320,44321,44322,44323,3355,3354,3357,3356,3351,3350,3353,3352,3359,3358,38741,38740,30240,30241,30532,30533,30530,30531,31111,31110,31117,31116,31115,51449,51448,51447,51446,51445,51444,51443,51442,51441,51440,59313,58303,59310,59317,59316,59315,58302,59319,59318,3322,3323,35140,35141,58307,58306,58305,58304,34631,34630,34633,34632,31425,35325,35329,55920,55921,51919,51918,51915,51914,51917,51916,51910,51913,51319,6178,6179,6176,6177,6174,6175,6172,32931,6170,6171,39231,32932,52520,32933,31805,31804,31807,31806,31801,31800,31803,31802,31809,31808,30508,51399,32216,4839,4838,4831,4830,4833,4832,4835,4834,4837,4836,36000,36001,36002,36003,36004,36005,36006,36007,36008,36009,8141,34407,34404,51241,34405,51716,34402,51243,8144,51242,8147,51245,8146,51246,59120,59121,41780,53405,53404,53407,53406,53401,53400,53403,53402,53408,33230,33231,33232,33233,37209,37208,37205,37204,37207,37206,37201,37200,37203,37202,8149,8148,34408,34409,34406,8140,8143,8142,8145,34403,34400,34401,40780,1399,1398,1397,1396,1395,1394,1393,1392,1391,1390,32804,32805,32806,32807,32800,32801,32802,32803,51058,32809,51588,55008,55003,55002,55001,55000,55007,55006,55005,55004,4710,56204,56205,56206,56207,56200,56201,56202,56203,56208,32116,32117,32115,32110,32111,4996,4997,4994,4995,4992,4993,4990,4991,4998,4999,3258,35131,31105,3250,3251,3252,3253,3254,3255,3256,3257,35132,59808,59807,59806,59805,59804,59803,59802,59801,59800,44348,44349,44342,44343,44340,44341,44346,44347,44344,44345,3333,3332,3331,3330,3337,3336,3335,3334,1498,58315,3339,58317,58310,58313,30515,30516,47780,30510,30511,36615,36617,36616,36611,36610,1234,1235,1236,1237,1230,1231,1232,1233,1238,1239,35125,35129,51079,34611,34610,34617,34616,34615,4670,39140,39141,50518,50519,50516,50517,50514,50515,50513,50510,51054,51055,32611,32610,32615,51056,32617,32616,52914,52915,52916,52917,52910,52913,51050,52918,52919,51051,4170,51052,51053,51075,32808,51059,51072,31825,31829,51589,51073,51582,4500,51583,51580,51581,51339,51587,51584,51585,51085,51335,39708,39709,39702,39703,39700,39701,39706,39707,39704,39705,58817,54513,54510,58814,58813,54517,54514,54515,54518,54519,58819,58818,53421,53420,37229,34010,37731,37730,37733,37732,37225,30709,30708,30701,30700,30703,30702,30705,30704,30707,30706,50210,50213,50215,50214,50217,50216,50219,50218,32811,51333,4349,4348,4347,4346,4345,4344,4343,4342,4341,4340,34425,34429,32816,51032,51033,51030,51031,51036,51037,51034,51035,51038,51039,43480,38416,32916,52219,52218,52217,52216,52215,52214,52213,52210,42680,32130,32131,32132,32133,53308,53302,53303,53300,53301,53306,53307,53304,53305,37502,37503,37500,37501,37506,37507,37504,37505,37508,37509,4978,4979,4974,4975,41880,4977,4970,4971,4972,4973,3276,3277,3274,3275,3272,3273,3270,3271,3278,3279,41080,32910,36901,36900,36903,36902,36905,36904,36907,36906,36909,36908,54307,54306,54305,54304,54303,54302,54301,54300,54308,3319,3318,38703,38702,38705,38704,38707,38706,3311,3310,3313,3312,3315,3314,3317,3316,51291,36633,36632,36631,36630,47480,58318,31517,31516,31515,44360,44361,44362,44363,44364,44365,44366,44367,44368,44369,58319,40680,1212,1213,1210,1211,1216,1217,1214,1215,1218,1219,59421,59420,35108,35109,31629,35100,35101,35102,35103,35104,35105,35106,35107,8400,54620,7575,54621,51095,50020,50021,35816,35817,35815,55218,55219,55213,55210,55216,55217,55214,55215,54617,4150,30309,38941,38940,30308,31841,31840,32633,32632,32631,32630,51371,51370,4560,59908,54716,39725,39729,33410,33411,65010,33415,54820,33141,30141,30140,37717,37240,37715,37711,37710,39615,39616,32733,4365,4364,4367,4366,4361,4360,4363,4362,4369,4368,30725,34441,38132,38133,38130,38131,30729,4090,35715,35717,35716,35711,35710,51018,51019,51548,51549,32840,32841,51012,51013,51014,51015,51016,51017,8097,8096,8095,8094,8093,8092,8091,8090,8099,8098,1567,57119,57118,57113,57110,57117,57116,57115,57114,3259,37529,37525,4958,4959,4952,4953,4950,4951,4956,4957,4954,4955,3298,3299,3294,3295,3296,3297,3290,3291,3292,3293,53320,53321,36929,33425,36925,36431,36430,36433,36432,33609,33608,33605,33604,33607,33606,33601,33600,33603,33602,45380,38729,38725,57805,57804,57807,57806,57801,57800,57803,57802,57808,44388,44389,44386,44387,44384,44385,44382,44383,44380,44381,1278,1279,1270,1271,1272,1273,1274,1275,1276,1277,59403,59402,59401,59400,59407,59406,59405,30809,30806,30807,30804,30805,30802,30803,30800,30801,1490,1491,1492,31609,1493,31603,31602,31601,31600,31607,31606,31605,31604,34125,1496,1497,34129,58314,1499,58316,35830,35831,35832,3338,50004,50005,50006,50007,50008,30517,4130,32431,32430,32433,32432,38925,38929,35525,35529,30808,55605,51209,51208,55604,51205,51204,51207,51206,51201,51200,51203,51202,53917,55606,52408,53916,52406,52407,52404,52405,52402,52403,52400,52401,53914,55603,4540,55602,51252,51253,51250,51251,51256,51254,51257,54804,54805,54806,54807,54800,54801,54802,54803,51255,54808,44445,44444,44447,44446,44441,44440,44443,44442,44449,44448,39630,58721,58720,30125,30129,4303,4302,4301,4300,4307,4306,4305,4304,4309,4308,54116,54117,54114,54115,33832,33833,54110,33831,54118,54119,38110,38111,62027,38115,38116,38117,62029,62028,32911,35733,35732,35731,35730,51564,51565,51566,51567,51560,51561,51562,51563,51568,51569,39241,39240,56514,56515,56516,56517,56510,56513,56518,56519,50615,50614,50617,50616,50610,50613,50619,50618,4930,4931,4932,4933,4934,4935,4936,4937,4938,4939,53120,53121,58113,58110,58116,58117,58114,58115,58118,58119,49480,52613,52610,52617,52616,52615,52614,52619,52618,36411,36410,36417,36416,36415,54619,54618,33629,33331,33330,33333,33332,54615,54614,33625,54616,34811,34810,48280,34815,34817,34816,57821,57820,30825,30829,37106,37107,37104,37105,37102,37103,37100,37101,37108,37109,34103,34102,34101,34100,34107,34106,34105,34104,34109,34108,1256,1257,1254,1255,1252,1253,1250,1251,1528,1529,1258,1259,55014,55015,55016,51022,4110,51025,38025,51026,38305,38304,38307,38306,38301,38300,38303,38302,32417,32416,32415,38309,38308,32411,32410,38909,38908,38907,38906,38905,38904,38903,38902,38901,38900,35508,35509,39516,35504,35505,35506,35507,35500,35501,35502,35503,33907,51229,51228,51223,51222,51221,51220,51227,51226,51225,51224,56708,56701,56700,56703,56702,56705,56704,56707,56706,45480,46280,52420,52421,33102,33103,33100,33101,33106,33107,33104,33105,33108,33109,44280,38316,44463,44462,44461,44460,44467,44466,44465,44464,44469,44468,58707,58706,58705,58704,58703,58702,58701,58700,1524,58708,30109,30108,30107,30106,30105,30104,30103,30102,30101,30100,4329,4328,4321,4320,4323,4322,4325,4324,4327,4326,37829,33815,33816,33817,33810,33811,1359,31410,31411,31416,31417,31415,51502,51503,51500,1520,51506,51507,51504,51505,51508,51509,39229,50900,50903,50902,50905,50904,50907,50906,50908,39225,4918,4919,4916,4917,4914,4915,4912,4913,4910,4911,53108,53100,53101,53102,53103,53104,53105,53106,53107,135,53818,53819,53813,53810,53816,53817,53814,53815,34833,34832,34831,34830,80,33641,33640,33315,33311,33310,59915,59914,59917,30841,50819,59913,50818,34341,34340,31508,39410,39411,39416,39417,39415,35025,31641,31640,37129,37125,3368,1502,1503,1500,1501,1506,1507,1504,1505,1508,1509,32529,55418,55419,38325,55410,38329,55413,55414,55415,55416,55417,33515,37815,51717,51240,51715,51714,51713,51244,51247,51710,51249,51248,33840,51719,51718,3365,1290,32031,32030,32033,32032,56721,56720,53719,53718,53715,53714,53717,53716,53710,53713,53314,49580,33129,33125,38525,38529,34411,4490,48180,44409,44408,44401,44400,44403,44402,44405,44404,44407,44406,38708,37807,37806,37805,37804,37803,37802,37801,37800,37809,37808,47980,51528,51529,51520,51521,51522,51523,51524,51525,51526,51527,32541,47180,32540,39207,39206,39205,39204,39203,39202,39201,39200,39209,39208,31430,31431,31432,31433,50921,50920,51388,55608,32208,32209,32206,32207,32204,32205,32202,32203,32200,32201,51586,31925,4700,31929,1335,1560,56808,1561,56806,56807,56804,56805,56802,56803,56800,56801,1563,1564,4640,1565,57608,1566,57603,57602,57601,57600,57607,57606,57605,57604,52121,52120,33432,36329,33433,36325,33430,33431,54516,58810,7270,59601,59600,59603,59602,59605,59604,59607,59606,59608,53520,53521,37329,37325,30316,30317,30315,30640,30641,30310,30311,39430,39431,39432,39433,37140,37141,1485,3386,1489,58516,32500,58514,58515,58513,58510,58518,58519,1568,1569,1298,1299,1292,1293,1562,1291,1296,1297,1294,1295,51475,34141,34140,38341,38340,32505"

            self.nmap.scan(ip, ports, arguments='-n --open --datadir ./nmap-erpscan -sV -Pn')
    
#            print(str(self.nmap));
            if not (str(ip) in self.nmap.all_hosts()):
                print('Host is down: {}. Skipping it'.format(ip))
                continue
            result[ip] = self.nmap[ip]
            print(self.nmap.command_line())
            for port in self.nmap[ip]['tcp'].keys():
                print(self.nmap[ip]['tcp'][port])

            # Mongo expects strings as keys. Keys conversion.
            if 'tcp' in result[ip]:
                result[ip]['tcp'] = {str(k):v for k,v in result[ip]['tcp'].items()}
            if 'udp' in result[ip]:
                result[ip]['udp'] = {str(k):v for k,v in result[ip]['udp'].items()}

            result[ip]['nmap_xml'] = self.nmap.get_nmap_last_output()
            
            filename = "nmap_" + ip + ".xml"
            with open(path + "/" + filename, "w") as xmlfile:
                xml = self.nmap.get_nmap_last_output()
                # WARNING: this might be vulnerable if it did not match the intended part
                m = re.search('file://(.*nmap.xsl)', xml)
                copyfile(m.group(1), path+"/nmap.xsl")
                xml = re.sub(r"file://(.*)nmap.xsl", r"nmap.xsl", xml)
                
                print(xml, file=xmlfile)
                self.reportOutputFile(filename)

            scanned += 1


        self.reportProgress({'percentage': 100*scanned/total, 'description' : '{}/{})'.format(str(scanned),str(total))})
        print(result)
        return {'status': 'done', 'result': {'hosts': result}}



a = NmapErpscanAction()
a.scan()
